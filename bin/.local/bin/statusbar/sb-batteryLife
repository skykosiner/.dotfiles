#!/usr/bin/env bash

capacity=$(cat /sys/class/power_supply/BAT0/capacity) || exit
status=$(cat /sys/class/power_supply/BAT0/status)

# Check if headphones is connected with bluetooth
headphones=$(bluetoothctl info | grep "Name" | grep "WH-1000XM3" | wc -l)
headphonesBattery=$(bluetoothctl info | grep "Battery Percentage" | cut -d' ' -f4 | sed "s/(//; s/)/%/")

if [[ $headphones -eq 1 ]]; then
    printf "ðŸŽ§"$headphonesBattery"% %"
fi

if [[ $status == "Full" ]]; then
    printf "ðŸ”Œ"$capacity"%%"
elif [[ $status == "Charging" ]]; then
    printf "ðŸ”Œ"$capacity"%%"
else
    printf "ðŸ”‹"$capacity"%%"
fi
