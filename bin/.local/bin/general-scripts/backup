#!/usr/bin/env bash

networkName=$(iwgetid -r)

if [[ -z $networkName && ${networkName+x} ]];
then
    echo "Connect to Wi-Fi to backup computer"
    notify-send "Connect to Wi-Fi to backup computer"
    exit 0
fi

filesInServerFolder=$(ls ~/server | wc -l)

if [[ $filesInServerFolder -le 1 ]]; then
    echo "Not mounted to server"
    notify-send "Not mounted to server"
    exit 0
fi

notify-send "Starting to backup computer to server"

sudo rsync -aAXv --delete /home/sky/Documents /home/sky/server/backups
sudo rsync -aAXv --delete /home/sky/work /home/sky/server/backups
sudo rsync -aAXv --delete /home/sky/personal /home/sky/server/backups
sudo rsync -aAXv --delete /home/sky/Pictures/ /home/sky/server/backups

notify-send "Backup is finished"

# Make dir of all my tiktoks I've saved lmfao
# pushd ~/server/backups/Camera/Camera/
# for f in *.mp4; do
    # file=$(echo $f | grep -v "^$(date +%Y)")
    # sudo cp /home/sky/server/backups/Camera/Camera/$file /home/sky/server/backups/tiktoks/
# done
# popd
