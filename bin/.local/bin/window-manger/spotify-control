#!/usr/bin/env bash

case "$1" in
    "-togglePlay")
        ~/.local/bin/spotifycli --playpause
        if ~/.local/bin/spotifycli --status; then
            notify-send "Now playing: $(~/.local/bin/spotifycli --status)"
        else
            notify-send "Spotify is not running"
        fi
        ;;
    "-prev")
        ~/.local/bin/spotifycli --prev
        ;;
    "-next")
        ~/.local/bin/spotifycli --next
        ;;
    "-status")
        if ~/.local/bin/spotifycli --status;
        then
            echo "$(~/.local/bin/spotifycli --status)"
        else
            echo ""
        fi
        ;;
    "-status-wm")
        if ~/.local/bin/spotifycli --status;
        then
            echo "$(~/.local/bin/spotifycli --status)"
        else
            echo ""
        fi
        ;;
        "-select-album")
            id=$(cat ~/.dotfiles/album_list | sort | awk -F '|' '{print $1 " - "  $2 " id: " $3}' | dmenu -l 20 -i  -fn 'JetBrainsMono Nerd Font-15' | awk -F 'id: ' '{print $2}')

            if [[ ! -z $id ]]; then
                qdbus org.mpris.MediaPlayer2.spotify \
                    /org/mpris/MediaPlayer2 \
                    org.mpris.MediaPlayer2.Player.OpenUri \
                    spotify:album:$id
            fi
        ;;
    "-select-playlist")
            id=$(spt list --playlists | dmenu -l 30 -fn "JetBrainsMono Nerd Font-15" | awk -F 'playlist:' '{print $2}' | sed "s/)//")

            if [[ ! -z $id ]]; then
                qdbus org.mpris.MediaPlayer2.spotify \
                    /org/mpris/MediaPlayer2 \
                    org.mpris.MediaPlayer2.Player.OpenUri \
                    spotify:playlist:$id
            fi
            ;;

        "-play-song")
            songToLookFor=$(dmenu -p "Enter Song > " -h 40 -fn 'JetBrainsMono Nerd Font-15' <&- && echo)
            song=$(spt search --tracks "$songToLookFor" | dmenu -l 30 -fn 'JetBrainsMono Nerd Font-15' | awk -F 'track:' '{print $2}' | sed "s/)//")
            spt play --uri "spotify:track:$song"
            ;;
        *) echo "Not a command... $1"
esac
